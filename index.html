<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="ja"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1">&lt;title&gt;クイズ × キャラコレコレクション（完全版・PW対応）&lt;/title&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>:root{ --bg:#f7f7fb; --card:#ffffff; --ink:#222; --muted:#667; --brand:#4e6cf4; --ok:#2aa776; --warn:#e6a100; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>*{box-sizing:border-box}</p>
<p class="p1"><span class="Apple-converted-space">  </span>body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic UI","Yu Gothic",Meiryo,sans-serif;background:var(--bg);color:var(--ink)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>header{padding:16px 20px;background:var(--card);box-shadow:0 2px 10px rgba(0,0,0,.05);position:sticky;top:0;z-index:10}</p>
<p class="p1"><span class="Apple-converted-space">  </span>h1{font-size:20px;margin:0}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.wrap{max-width:980px;margin:20px auto;padding:0 16px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.row{display:flex;flex-wrap:wrap;gap:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.card{background:var(--card);border-radius:16px;box-shadow:0 4px 16px rgba(0,0,0,.06);padding:16px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.login,.controls,.quiz,.collection,.teacher{width:100%}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.login .row &gt; *{flex:1}</p>
<p class="p1"><span class="Apple-converted-space">  </span>input[type="text"], input[type="password"], select{width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:10px;font-size:16px;background:#fff}</p>
<p class="p1"><span class="Apple-converted-space">  </span>button{cursor:pointer;border:none;border-radius:12px;padding:10px 14px;font-weight:700}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.btn{background:var(--brand);color:#fff}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.btn.secondary{background:#e6e8ff;color:#2b2f7e}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.btn.ghost{background:#eef0f7;color:#2b2f7e}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.muted{color:var(--muted)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.quiz h2{margin:0 0 8px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.options{display:grid;gap:10px;margin-top:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.opt{padding:12px;border:2px solid #e7e7ee;border-radius:12px;background:#fff;text-align:left}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.opt.correct{border-color:var(--ok)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.opt.wrong{border-color:#d33}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.status{display:flex;align-items:center;gap:8px;margin-top:8px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.pill{padding:6px 10px;border-radius:999px;background:#eef0f7;font-size:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.result-area{margin-top:14px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.result-area img{max-width:160px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.12)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.grid img{width:100%;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.12)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.split{display:grid;grid-template-columns:1.1fr .9fr;gap:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>@media (max-width:900px){.split{grid-template-columns:1fr}}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.progressbar{height:10px;background:#eef0f7;border-radius:999px;overflow:hidden}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.progressbar &gt; span{display:block;height:100%;background:linear-gradient(90deg,var(--ok),#67d6a7)}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.small{font-size:12px}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.badge{background:#fff3c2;color:#6b4b00;border:1px solid #ffe28a}</p>
<p class="p1"><span class="Apple-converted-space">  </span>.right{display:flex;gap:8px;align-items:center;justify-content:flex-end}</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;header&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="wrap row" style="align-items:center;justify-content:space-between;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h1&gt;クイズ × キャラコレ（PW対応）&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="right"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn ghost" id="teacherBtn"&gt;教師モード&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn secondary" id="showCollectionBtn"&gt;コレクション&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn ghost" id="logoutBtn" style="display:none"&gt;ログアウト&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p1">&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- Login --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;section class="card login" id="loginCard"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h2 style="margin:0 0 8px"&gt;ログイン&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;p class="muted small"&gt;ニックネーム＋パスワードでログイン。初回は新規登録になります。&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;&lt;input id="nickname" type="text" autocomplete="username" placeholder="ニックネームを入力" /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;&lt;input id="password" type="password" autocomplete="current-password" placeholder="パスワード" /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="flex:0 0 auto"&gt;&lt;button class="btn" id="loginBtn"&gt;はじめる&lt;/button&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;p class="muted small" id="loginHelp" style="margin-top:8px"&gt;※ ブラウザのローカル保存のみ（学校PC共有の場合はご注意ください）&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- Controls --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;section class="card controls" id="controlsCard" style="display:none"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="row" style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;label class="small muted"&gt;単元&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;select id="unitSelect"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;label class="small muted"&gt;小単元&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;select id="subunitSelect"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="flex:0 0 auto;display:flex;gap:8px;align-items:flex-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn ghost" id="prevQ"&gt;← 前の問題&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn" id="nextQ"&gt;次の問題 →&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="row" style="margin-top:10px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="status"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;span class="pill"&gt;ユーザー：&lt;b id="currentUserLabel"&gt;-&lt;/b&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;span class="pill"&gt;進捗：&lt;span id="progressText"&gt;0/5&lt;/span&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;span class="pill badge"&gt;初回正解でキャラGET！&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="progressbar" style="margin-top:8px"&gt;&lt;span id="progressBar" style="width:0%"&gt;&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="flex:0 0 auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn secondary" id="resetSubunit"&gt;この小単元の進捗をリセット&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="split"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Quiz --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;section class="card quiz" id="quizCard" style="display:none"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h2 id="subunitTitle"&gt;-&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="muted small" id="qCounter"&gt;1 / 5&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div id="questionText" style="margin-top:8px;font-size:18px;font-weight:600"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div id="options" class="options"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div id="feedback" class="result-area"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Collection --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;section class="card collection" id="collectionCard" style="display:none"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="display:flex;justify-content:space-between;align-items:center;gap:10px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2 style="margin:0"&gt;コレクション&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button class="btn ghost" id="hideCollectionBtn"&gt;閉じる&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p class="muted small"&gt;コンプリートを目指そう！&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div id="collectionGrid" class="grid"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/section&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- Teacher --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;section class="card teacher" id="teacherCard" style="display:none"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h2 style="margin:0 0 8px"&gt;教師モード&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn ghost" id="switchUserBtn"&gt;ユーザー切替&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn" id="exportBtn"&gt;進捗をJSONエクスポート&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn" id="wipeBtn"&gt;このユーザーの全データ削除&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button class="btn secondary" id="changePwBtn"&gt;このユーザーのパスワード変更&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;pre id="exportBox" style="margin-top:12px;white-space:pre-wrap;word-break:break-all;background:#0b1020;color:#e6ecff;border-radius:12px;padding:12px;display:none"&gt;&lt;/pre&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/section&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">/* ================= 画像：Google Drive直リンク ================ */</p>
<p class="p1">const allCharacters = [</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=12m_FCI2-jGCBj7HkMRiF89KAqLEeZ7um",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1t-4CTjAw8ku78iI6aQZg82zphbyaJzSx",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=148-SiuyH2OipZN0hqqYf8-FBbEPY8P_1",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1k8icMUbPhviCCgk6J47-VzY16INULG85",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1qbqoxhkqsflv_KoeaCt4kMXhLnpu2Wis",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=17ry9Ema2PArSHv-4zrYaW_nKqK6oD1qA",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1fLgzf-xDjx2bcidnU1zhrfbVZQCSj_IG",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1FDzuAcYObFPL_q5LyrtLP6fOOI2q0GI8",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1mtaNPgux84by8y-QU9YESO3NB_OApbDW",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1kL99PFhjccY04BdmrxCdkxosPxUsabtq",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1t_RdRHSDC1g4PXjqqH_Fa0pvBWWZGuE_",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1Ve9ADY8hC9J3eWQZ84ytOQWdLJE92pMY",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1fCYZ7u9i6KWMUOti-eYgE3AhG0ayEYKk",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1kwN9Yr2oDlRcTn_P6_Us2vPPg1x_6FkQ",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1bRSdKUBiNPZEFoM5pyKTgSLi6g_Tkuw5",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1ZI9lQ7uScYH2rp3JqKbWbor2fm3DQw8M",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1z99Ako8UvPAiGUEzvTFUkfjIPh5rao99",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1nn5W-UMANpU08CcrOkCHJDl-m_F6lNj2",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1_0e9GUYLL_Vr3aPkFLbiSsBObSpFv5bp",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=18DtAiqa3Ooss1NgfMiDNmhJW_U3ZVY6R",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1_3J_WNokM6NLQ1u0E-U7gcyWfHI7Yzwh",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1JBDFQQUdvYf2wgYVwtbZ1hUaTImB8PBM",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1ltDo3jLgNyyF5o-m5RtZJxKi5yRrB2JA",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=12ImpwqqcxvprQf2TEW4y-_9YD2c12Jk3",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1PU2-zwMerVwFtAIBPrpWbpYvDLSMaJ1C",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1Mbr4h8nsUNzzviseyZUhQIe7Vj6Xdpao",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1p956pFZmN83mIt2D5VVtoTBurjlR2XJR",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1weZwwa9j0Qkdip5hhZuEbHccUGOug_6b",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=13IffBmqFxl9sr4q3Tx22zUWgjVYHQP5b",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1Yxtii9ngfFIJKFHX8I7gUj5kNMBXh4NS",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1tlKec643oljq-q6hnttsZCmzDLFGMibZ",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1OAllQQjTA9jtDAW_2qTM8Q0GnlWif8Wf",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1zVPXfi9ZVmoxvT7kxJaN-mlPcdLkHdXH",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=15_ugE6oappJ9nSbUa2VCooGTXXnlWXRc",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1bIoaJvkS4C_vxHSD_e2pQ1UU5qtRr5p-",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1-3BCNFwZWatqwxobHPwDjHzH7Jt-xZvp",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=17_Aiyq09FzIHBoZYjiiK4dRKsqmzX2w4",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1ul2gNCCm3oKZSc8kP4Y9wioUP83XqVDa",</p>
<p class="p1"><span class="Apple-converted-space">  </span>"https://drive.google.com/uc?export=view&amp;id=1IgGcACVDSQ2SUvcc5wsZoTgCwVNmk3tJ"</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 問題データ（全単元） ================ */</p>
<p class="p1">const units = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>"1-1 線対称": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "線対称の図形で、対称の軸は何本ありますか？正方形の場合", options: ["1","2","3","4"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "線対称な図形はどれですか？", options: ["三角定規","L字型","台形","五角形"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "線対称の図形でないものはどれですか？", options: ["円","二等辺三角形","長方形","不等辺三角形"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "ひし形の対称の軸は何本ですか？", options: ["1","2","3","4"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "線対称の図形は鏡に映すとどうなりますか？", options: ["同じ形になる","形が変わる","反転して違う形になる","大きくなる"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"1-2 点対称": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "点対称な図形はどれですか？", options: ["正方形","円","長方形","ひし形"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "アルファベットで点対称な文字はどれですか？", options: ["A","B","C","H"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "点対称な図形は、180度回転させるとどうなりますか？", options: ["同じ形になる","逆さまになるが形は同じ","全く違う形になる","大きくなる"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "点対称でない図形はどれですか？", options: ["円","五角形","長方形","正三角形"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "正六角形は点対称ですか？", options: ["はい","いいえ","場合による","わからない"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"2-1 文字を使った式の表し方": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "x個のリンゴがあり、1個100円なら代金は？", options: ["100x","x+100","100+x","x-100"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "縦xcm、横ycmの長方形の面積は？", options: ["x+y","xy","x-y","2x+2y"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1個a円のお菓子をb個買う代金は？", options: ["a+b","a-b","ab","a/b"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "m分を秒にすると？", options: ["60m","m/60","m+60","m-60"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "縦x、横yの長方形の周の長さは？", options: ["x+y","2x+2y","xy","x-y"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"2-2 文字を使った式の計算": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3x+5xは？", options: ["8x","15x","x^8","2x"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2x-7xは？", options: ["-5x","5x","x","7x"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "x×xは？", options: ["2x","x^2","x^3","x/2"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4x÷2は？", options: ["2x","x","8x","x/2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5x+3yはこれ以上簡単にできる？", options: ["できる","できない","場合による","わからない"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"3-1 分数×整数": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3/4×8は？", options: ["6","8","9","10"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2/5×10は？", options: ["2","4","6","8"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7/8×16は？", options: ["12","14","15","13"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5/6×12は？", options: ["8","10","12","14"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4/9×27は？", options: ["10","12","14","16"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"3-2 分数÷整数": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3/4÷2は？", options: ["3/8","3/6","3/2","6/4"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5/6÷5は？", options: ["1/6","5/30","5/11","6/5"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7/8÷7は？", options: ["1/8","7/15","1/16","15/7"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2/3÷4は？", options: ["2/12","1/6","2/7","3/8"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "9/10÷3は？", options: ["3/10","3/13","1/3","10/27"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"3-3 分数×分数": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2/3×3/4は？", options: ["1/2","2/7","3/8","1/3"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5/6×2/5は？", options: ["1/3","2/3","5/12","1/6"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7/8×4/7は？", options: ["1/2","4/8","1/3","2/7"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3/5×5/9は？", options: ["1/3","1/2","5/15","3/14"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4/7×14/5は？", options: ["8/5","4/5","2/7","7/8"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"4-1 分数÷分数": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2/3÷4/5は？", options: ["5/6","6/5","3/5","5/3"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3/4÷2/7は？", options: ["21/8","8/21","7/8","3/14"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5/6÷5/12は？", options: ["2","1/2","5/10","12/5"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7/8÷1/4は？", options: ["7/2","8/7","7/32","1/2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "9/10÷3/5は？", options: ["3/2","2/3","5/6","10/27"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"4-2 分数の倍": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3/4の2倍は？", options: ["3/2","6/4","1/2","4/3"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5/6の3倍は？", options: ["15/6","5/2","3/5","6/5"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2/5の4倍は？", options: ["8/5","5/8","4/5","2/8"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7/8の0.5倍は？", options: ["7/16","16/7","1/2","14/8"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "9/10の1.5倍は？", options: ["27/20","20/27","3/5","5/3"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"5-1 比の意味": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3:4は次のどれと等しいですか？", options: ["6:8","4:5","9:10","12:13"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2:5と等しい比は？", options: ["4:10","5:12","3:5","7:9"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5:8と等しい比は？", options: ["10:16","8:13","15:24","1:2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1:3と等しい比は？", options: ["2:6","3:9","4:12","全部"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "6:9を簡単にすると？", options: ["2:3","3:4","4:5","3:5"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"5-2 比の値の計算": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "8:12の値は？", options: ["2/3","3/2","4/6","6/4"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5:20の値は？", options: ["1/4","4","5","20"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "9:15の値は？", options: ["3/5","5/3","2/3","1/2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "7:14の値は？", options: ["1/2","2","7/14","14/7"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "12:18の値は？", options: ["2/3","3/2","4/6","6/4"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"5-3 比の利用": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3:5の比で8個のボールを分けます。少ない方は何個ですか？", options: ["3","4","5","8"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2:3の比で20個の飴を分けます。多い方は何個ですか？", options: ["8","10","12","15"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4:1の比で10Lのジュースを分けます。少ない方は何Lですか？", options: ["2","4","6","8"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5:7の比で24mのリボンを分けます。多い方は何mですか？", options: ["10","12","14","16"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1:4の比で25枚のカードを分けます。多い方は何枚ですか？", options: ["4","5","20","25"], answer: 3 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"6-1 拡大図": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "長さ4cmの線分を、2倍に拡大すると長さは何cmになりますか？", options: ["6","8","10","12"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "三角形の各辺の長さが2cm, 3cm, 4cmのとき、1.5倍に拡大した三角形の最も長い辺は何cmですか？", options: ["5","5.5","6","6.5"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "正方形の一辺が5cmの図形を、3倍に拡大したときの一辺の長さは何cmですか？", options: ["10","12","15","20"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径3cmの円を2倍に拡大したときの半径は何cmですか？", options: ["5","6","7","8"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "長さ9cmの線分を、0.5倍に縮小すると長さは何cmになりますか？", options: ["4.5","5","6","7"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"6-2 縮図": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "実際の長さ20mを、1/100の縮尺で表すと何cmになりますか？", options: ["20","200","2","0.2"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "地図上で5cmの距離が、実際には1kmのときの縮尺はどれですか？", options: ["1/20000","1/50000","1/10000","1/25000"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "実際の距離300mを、1/500の縮尺で表すと図上では何cmになりますか？", options: ["60","6","0.6","600"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "地図上で12cmの距離が、実際には480mであるとき、縮尺はどれですか？", options: ["1/40","1/400","1/4000","1/4800"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "実際の長さ8mを1/200の縮尺で描くと、図の長さは何cmになりますか？", options: ["40","4","0.4","400"], answer: 4 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"7-1平均値と中央値": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5, 8, 10 の平均値は？", options: ["7","8","9","10"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3, 5, 7 の中央値は？", options: ["3","5","7","6"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4, 6, 8, 10 の平均値は？", options: ["7","8","6","9"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1, 3, 5, 7, 9 の中央値は？", options: ["3","5","7","4"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2, 4, 6, 8 の中央値は？", options: ["4","5","6","7"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"7-2度数分布表と柱状グラフ": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "度数分布表で最も多い区間を何と呼ぶ？", options: ["平均","最頻値","中央値","範囲"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "柱状グラフはどんなデータに向いている？", options: ["時間の変化","割合の比較","数値の分布","位置の変化"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "度数分布表で階級の幅が大きいほど？", options: ["細かく見える","大まかになる","変わらない","不明"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "柱状グラフの縦軸は何を表す？", options: ["度数","割合","時間","階級"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "帯グラフは何を表すのに便利？", options: ["時間","割合","位置","順序"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"7-3折れ線グラフと帯グラフ": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "折れ線グラフは何を表す？", options: ["時間の変化","割合の比較","分布","順序"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "帯グラフの全体の長さは何を表す？", options: ["100%","合計","最大値","中央値"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "折れ線グラフで点を結ぶ線は何を示す？", options: ["変化の様子","割合","平均","範囲"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "帯グラフで色分けされている部分は何を表す？", options: ["項目別の割合","時間の変化","平均","階級"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "折れ線グラフと柱状グラフを組み合わせたものは？", options: ["複合グラフ","帯グラフ","散布図","ヒストグラム"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"8-1円の面積の求め方": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径5cmの円の面積は？(π=3.14)", options: ["78.5","31.4","25","62.8"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径10cmの円の面積は？(π=3.14)", options: ["314","157","100","62.8"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "直径8cmの円の半径は？", options: ["4","8","16","2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "円の面積の公式は？", options: ["πr²","2πr","r²","πd"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径3cmの円の面積は？(π=3.14)", options: ["28.26","18.84","9","31.4"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"8-2半円・扇形の面積": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径6cmの半円の面積は？(π=3.14)", options: ["56.52","113.04","18.84","28.26"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径4cm、中心角90°の扇形の面積は？(π=3.14)", options: ["12.56","25.12","50.24","6.28"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径5cm、中心角180°の扇形は何の形の半分？", options: ["円","長方形","三角形","楕円"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半円の面積を求めるには円の面積をどうする？", options: ["2倍","半分","3倍","4倍"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "扇形の面積の公式は？", options: ["πr²×中心角/360","2πr","πd","r²"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"9-1角柱の体積": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面積20cm²、高さ5cmの角柱の体積は？", options: ["100","25","200","10"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面が長方形の角柱の体積は底面積×何？", options: ["底辺","高さ","幅","奥行き"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面積50cm²、高さ2cmの角柱の体積は？", options: ["100","25","150","200"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "体積の単位は？", options: ["cm²","cm³","cm","m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面積10cm²、高さ10cmの角柱の体積は？", options: ["100","10","1","1000"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"9-2円柱の体積": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面積30cm²、高さ5cmの円柱の体積は？", options: ["150","35","300","15"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "円柱の体積の公式は？", options: ["底面積×高さ","2πr","πr²","高さ×周の長さ"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径3cm、高さ10cmの円柱の体積は？(π=3.14)", options: ["282.6","94.2","188.4","565.2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "体積の単位は？", options: ["cm³","cm²","cm","m²"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底面積15cm²、高さ4cmの円柱の体積は？", options: ["60","45","30","75"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"10-1面積のおよその値": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "長方形の面積をおよそ求めるとき、1辺が2.9mなら何mとして計算する？", options: ["2m","3m","4m","2.5m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径3.2cmの円の面積をおよそ求めるには半径を何cmとする？", options: ["3cm","3.5cm","4cm","2cm"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1.48mをおよその値にすると？", options: ["1m","1.5m","2m","1.4m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1.76mを四捨五入して整数にすると？", options: ["1m","2m","3m","1.5m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3.14をおよそ3とするのはどんなとき？", options: ["概算のとき","正確な計算のとき","面積を出すとき","誤差を出すとき"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"10-2体積のおよその値": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "高さが4.9mの円柱の体積をおよそ求めるとき、高さを何mとする？", options: ["4m","5m","6m","4.5m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径2.6mの円柱の体積をおよそ求めるとき、半径を何mとする？", options: ["2m","3m","2.5m","2.8m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "6.4mを四捨五入して整数にすると？", options: ["6m","7m","5m","8m"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3.2mをおよその値にすると？", options: ["3m","4m","2m","3.5m"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "体積の概算をする理由は？", options: ["計算を簡単にするため","正確にするため","測定のため","実験のため"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"11-1比例の意味とグラフ": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "比例の式は y=□x で表される。□に入るのは？", options: ["比例定数","割合","速度","比"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "xが2倍になるとyも2倍になるのは？", options: ["比例","反比例","等差数列","比例反比例"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "比例のグラフはどんな形？", options: ["直線","曲線","折れ線","放物線"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "比例のグラフは原点を通る？", options: ["通る","通らない","場合による","わからない"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "y=3xのとき、x=4ならyは？", options: ["12","7","8","3"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"11-2反比例の意味とグラフ": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "反比例の式は xy=□ で表される。□に入るのは？", options: ["定数","割合","速度","比"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "xが2倍になるとyは？", options: ["半分になる","2倍になる","変わらない","4倍になる"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "反比例のグラフはどんな形？", options: ["双曲線","直線","放物線","円"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "y=12/x のとき、x=3ならyは？", options: ["4","3","12","6"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "反比例のグラフは原点を通る？", options: ["通らない","通る","場合による","わからない"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"12-1順列（並べ方）": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3人を並べる順列は何通り？", options: ["6","3","9","12"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "n人の順列の式は？", options: ["n!","n²","n×n","nP2"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4人の順列は何通り？", options: ["24","12","8","16"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "順列で順番を入れ替えると別の並びとみなす？", options: ["はい","いいえ","場合による","わからない"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5人から3人を並べるのは何通り？", options: ["60","30","10","15"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"12-2組み合わせ": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5人から2人を選ぶ組み合わせは何通り？", options: ["20","10","5","15"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "組み合わせは順番を考える？", options: ["考えない","考える","場合による","わからない"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "4人から3人を選ぶ組み合わせは何通り？", options: ["4","12","6","3"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "6人から2人を選ぶ組み合わせは何通り？", options: ["12","20","10","15"], answer: 4 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"13-1総合問題（前半）": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "5×(2+3)の計算結果は？", options: ["25","20","10","15"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "1/2×1/4は？", options: ["1/6","1/8","1/4","1/2"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3:4の比を分数で表すと？", options: ["3/4","4/3","7","1"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "円の面積公式は？", options: ["半径×3.14","直径×3.14","半径×半径×3.14","半径×半径"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "底辺10cm、高さ5cmの三角形の面積は？", options: ["50","25","20","15"], answer: 2 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>"13-2総合問題（後半）": [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "反比例のグラフの形は？", options: ["直線","放物線","双曲線","円"], answer: 3 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "3人から2人を選ぶ組み合わせは？", options: ["6","3","9","2"], answer: 2 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "2.8mを四捨五入して整数にすると？", options: ["3","2","4","5"], answer: 1 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "y=5xのときx=2ならyは？", options: ["7","8","12","10"], answer: 4 },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ q: "半径7cmの円周の長さは？(π=3.14)", options: ["43.96","49","21.98","50"], answer: 1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>]</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 認証・保存まわり ================== */</p>
<p class="p1">const teacherPassword = "sensei"; // 教師モードPW（ここで変更可）</p>
<p class="p1">let currentUser = null;</p>
<p class="p2"><br></p>
<p class="p1">/* ---- keys ---- */</p>
<p class="p1">const AUTH_NS = "quiz_v2::auth::"; <span class="Apple-converted-space">                      </span>// 例）quiz_v2::auth::Taro<span class="Apple-converted-space">  </span>=&gt; {hash:"...", created:...}</p>
<p class="p1">const USER_KEY = "quiz_v2::user"; <span class="Apple-converted-space">                        </span>// 現在ログイン中ユーザー名</p>
<p class="p1">const storageKey = (sub) =&gt; `quiz_v2::${currentUser}::${sub}`;</p>
<p class="p1">const colKey <span class="Apple-converted-space">    </span>= () =&gt; `quiz_v2::${currentUser}::collection`;</p>
<p class="p1">const awardedKey = (sub, idx) =&gt; `quiz_v2::${currentUser}::awarded::${sub}::${idx}`;</p>
<p class="p1">const authKey<span class="Apple-converted-space">    </span>= (name) =&gt; `${AUTH_NS}${name}`;</p>
<p class="p2"><br></p>
<p class="p1">/* ---- auth helpers ---- */</p>
<p class="p1">async function sha256Hex(text){</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(window.crypto?.subtle){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const enc = new TextEncoder().encode(text);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const buf = await crypto.subtle.digest("SHA-256", enc);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return [...new Uint8Array(buf)].map(b=&gt;b.toString(16).padStart(2,"0")).join("");</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>// Fallback: 簡易ハッシュ（安全性は低いがローカル用途の最終手段）</p>
<p class="p1"><span class="Apple-converted-space">  </span>let h = 5381; for(let i=0;i&lt;text.length;i++){ h = ((h&lt;&lt;5)+h) ^ text.charCodeAt(i); }</p>
<p class="p1"><span class="Apple-converted-space">  </span>return ("00000000"+(h&gt;&gt;&gt;0).toString(16)).slice(-8);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function saveUser(name){ localStorage.setItem(USER_KEY, name); }</p>
<p class="p1">function loadUser(){ return localStorage.getItem(USER_KEY); }</p>
<p class="p1">function clearUser(){ localStorage.removeItem(USER_KEY); }</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 進捗管理 ================== */</p>
<p class="p1">function getProgress(sub){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const raw = localStorage.getItem(storageKey(sub));</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!raw) return { correct: [], cursor: 0 };</p>
<p class="p1"><span class="Apple-converted-space">  </span>try{ return JSON.parse(raw); }catch{ return { correct: [], cursor: 0 }; }</p>
<p class="p1">}</p>
<p class="p1">function setProgress(sub, data){ localStorage.setItem(storageKey(sub), JSON.stringify(data)); }</p>
<p class="p2"><br></p>
<p class="p1">/* ================== コレクション ================== */</p>
<p class="p1">function getCollection(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const raw = localStorage.getItem(colKey());</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!raw) return [];</p>
<p class="p1"><span class="Apple-converted-space">  </span>try{ return JSON.parse(raw); }catch{ return []; }</p>
<p class="p1">}</p>
<p class="p1">function setCollection(arr){ localStorage.setItem(colKey(), JSON.stringify(arr)); }</p>
<p class="p1">function awardCharacter(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const current = getCollection();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const remaining = allCharacters.filter(url =&gt; !current.includes(url));</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(remaining.length === 0){</p>
<p class="p1"><span class="Apple-converted-space">    </span>return { awarded:false, url:null, message:"コンプリートおめでとう！" };</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>const newUrl = remaining[Math.floor(Math.random()*remaining.length)];</p>
<p class="p1"><span class="Apple-converted-space">  </span>current.push(newUrl);</p>
<p class="p1"><span class="Apple-converted-space">  </span>setCollection(current);</p>
<p class="p1"><span class="Apple-converted-space">  </span>return { awarded:true, url:newUrl, message:"おめでとう！新しいキャラクターをゲット！" };</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ================== UI参照 ================== */</p>
<p class="p1">const loginCard = document.getElementById('loginCard');</p>
<p class="p1">const controlsCard = document.getElementById('controlsCard');</p>
<p class="p1">const quizCard = document.getElementById('quizCard');</p>
<p class="p1">const collectionCard = document.getElementById('collectionCard');</p>
<p class="p1">const teacherCard = document.getElementById('teacherCard');</p>
<p class="p2"><br></p>
<p class="p1">const currentUserLabel = document.getElementById('currentUserLabel');</p>
<p class="p1">const unitSelect = document.getElementById('unitSelect');</p>
<p class="p1">const subunitSelect = document.getElementById('subunitSelect');</p>
<p class="p1">const qCounter = document.getElementById('qCounter');</p>
<p class="p1">const subunitTitle = document.getElementById('subunitTitle');</p>
<p class="p1">const questionText = document.getElementById('questionText');</p>
<p class="p1">const optionsDiv = document.getElementById('options');</p>
<p class="p1">const feedback = document.getElementById('feedback');</p>
<p class="p1">const progressText = document.getElementById('progressText');</p>
<p class="p1">const progressBar = document.getElementById('progressBar');</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 認証UI挙動 ================== */</p>
<p class="p1">document.getElementById('loginBtn').addEventListener('click', async ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>const name = (document.getElementById('nickname').value || "").trim();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pw = (document.getElementById('password').value || "");</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!name){ alert("ニックネームを入力してください"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!pw){ alert("パスワードを入力してください"); return; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const authRaw = localStorage.getItem(authKey(name));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pwHash = await sha256Hex(pw);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!authRaw){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// 新規登録</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ok = confirm(`「${name}」を新規作成します。よろしいですか？`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(!ok) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>localStorage.setItem(authKey(name), JSON.stringify({ hash: pwHash, created: Date.now() }));</p>
<p class="p1"><span class="Apple-converted-space">    </span>currentUser = name; saveUser(name);</p>
<p class="p1"><span class="Apple-converted-space">    </span>afterLogin();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">    </span>// 既存ユーザー → 検証</p>
<p class="p1"><span class="Apple-converted-space">    </span>try{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rec = JSON.parse(authRaw);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(rec.hash === pwHash){</p>
<p class="p1"><span class="Apple-converted-space">        </span>currentUser = name; saveUser(name);</p>
<p class="p1"><span class="Apple-converted-space">        </span>afterLogin();</p>
<p class="p1"><span class="Apple-converted-space">      </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert("パスワードが違います");</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}catch{</p>
<p class="p1"><span class="Apple-converted-space">      </span>alert("認証データの読み込みに失敗しました");</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">document.getElementById('logoutBtn').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(confirm("ログアウトしますか？")){</p>
<p class="p1"><span class="Apple-converted-space">    </span>clearUser(); currentUser = null; showLogin();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 教師モード ================== */</p>
<p class="p1">document.getElementById('teacherBtn').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pw = prompt("教師モードパスワードを入力してください");</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(pw === teacherPassword){</p>
<p class="p1"><span class="Apple-converted-space">    </span>teacherCard.style.display = "block";</p>
<p class="p1"><span class="Apple-converted-space">  </span>}else if(pw !== null){</p>
<p class="p1"><span class="Apple-converted-space">    </span>alert("パスワードが違います");</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">});</p>
<p class="p1">document.getElementById('switchUserBtn').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>const name = prompt("切り替えるユーザー名（ニックネーム）を入力");</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!name) return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pw = prompt(`ユーザー「${name}」のパスワードを入力`);</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(pw===null) return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>// 認証チェック</p>
<p class="p1"><span class="Apple-converted-space">  </span>sha256Hex(pw).then(hash=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>const raw = localStorage.getItem(authKey(name));</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(!raw){ alert("そのユーザーは登録されていません"); return; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>try{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rec = JSON.parse(raw);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(rec.hash === hash){</p>
<p class="p1"><span class="Apple-converted-space">        </span>currentUser = name.trim(); saveUser(currentUser);</p>
<p class="p1"><span class="Apple-converted-space">        </span>startApp();</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert(`ユーザーを「${currentUser}」に切り替えました`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert("パスワードが違います");</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}catch{ alert("認証データの読み込みに失敗しました"); }</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1">});</p>
<p class="p1">document.getElementById('wipeBtn').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!currentUser){ alert("ユーザー未選択"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!confirm(`${currentUser} の全データ（進捗・コレクション）を削除します。よろしいですか？`)) return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>Object.keys(localStorage).forEach(k=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(k.startsWith(`quiz_v2::${currentUser}::`)) localStorage.removeItem(k);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>alert("学習データを削除しました（認証は残しています）");</p>
<p class="p1"><span class="Apple-converted-space">  </span>startApp();</p>
<p class="p1">});</p>
<p class="p1">document.getElementById('exportBtn').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!currentUser){ alert("ユーザー未選択"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>const dump = {};</p>
<p class="p1"><span class="Apple-converted-space">  </span>Object.keys(localStorage).forEach(k=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(k.startsWith(`quiz_v2::${currentUser}::`)){</p>
<p class="p1"><span class="Apple-converted-space">      </span>dump[k] = localStorage.getItem(k);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pre = document.getElementById('exportBox');</p>
<p class="p1"><span class="Apple-converted-space">  </span>pre.textContent = JSON.stringify(dump, null, 2);</p>
<p class="p1"><span class="Apple-converted-space">  </span>pre.style.display = "block";</p>
<p class="p1">});</p>
<p class="p1">document.getElementById('changePwBtn').addEventListener('click', async ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!currentUser){ alert("ユーザー未選択"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>const oldPw = prompt("現在のパスワードを入力");</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(oldPw===null) return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const raw = localStorage.getItem(authKey(currentUser));</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!raw){ alert("認証データが見つかりません"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>let rec; try{ rec = JSON.parse(raw); }catch{ alert("認証データ読込失敗"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>const oldHash = await sha256Hex(oldPw);</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(rec.hash !== oldHash){ alert("現在のパスワードが違います"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>const newPw = prompt("新しいパスワードを入力（8文字以上推奨）");</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(newPw===null || !newPw){ alert("変更を中止しました"); return; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>const newHash = await sha256Hex(newPw);</p>
<p class="p1"><span class="Apple-converted-space">  </span>localStorage.setItem(authKey(currentUser), JSON.stringify({ ...rec, hash:newHash, changed: Date.now() }));</p>
<p class="p1"><span class="Apple-converted-space">  </span>alert("パスワードを更新しました");</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">/* ================== 学習UI操作 ================== */</p>
<p class="p1">document.getElementById('showCollectionBtn').addEventListener('click', showCollection);</p>
<p class="p1">document.getElementById('hideCollectionBtn').addEventListener('click', ()=&gt;{ collectionCard.style.display = "none"; });</p>
<p class="p1">document.getElementById('prevQ').addEventListener('click', ()=&gt;moveQuestion(-1));</p>
<p class="p1">document.getElementById('nextQ').addEventListener('click', ()=&gt;moveQuestion(1));</p>
<p class="p1">document.getElementById('resetSubunit').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sub = subunitSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!confirm(`${sub} の進捗（正解履歴）をリセットします。よろしいですか？`)) return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>setProgress(sub, { correct: [], cursor: 0 });</p>
<p class="p1"><span class="Apple-converted-space">  </span>renderQuestion();</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">/* ===== 単元 / 小単元リスト ===== */</p>
<p class="p1">function buildUnitMap(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const map = {};</p>
<p class="p1"><span class="Apple-converted-space">  </span>Object.keys(units).forEach(key=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>const unitNo = (key.split('-')[0]||"").trim();</p>
<p class="p1"><span class="Apple-converted-space">    </span>map[unitNo] = map[unitNo] || [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>map[unitNo].push(key);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>Object.keys(map).forEach(no=&gt;{ map[no].sort((a,b)=&gt; a.localeCompare(b,'ja')); });</p>
<p class="p1"><span class="Apple-converted-space">  </span>return map;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ===== 画面切替 ===== */</p>
<p class="p1">function showLogin(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>loginCard.style.display = "block";</p>
<p class="p1"><span class="Apple-converted-space">  </span>controlsCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>quizCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>collectionCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>teacherCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('logoutBtn').style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('nickname').value = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('password').value = "";</p>
<p class="p1">}</p>
<p class="p1">function afterLogin(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>startApp();</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('logoutBtn').style.display = "inline-block";</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ===== アプリ開始 ===== */</p>
<p class="p1">function startApp(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>loginCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>controlsCard.style.display = "block";</p>
<p class="p1"><span class="Apple-converted-space">  </span>quizCard.style.display = "block";</p>
<p class="p1"><span class="Apple-converted-space">  </span>collectionCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>teacherCard.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">  </span>currentUserLabel.textContent = currentUser || "-";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const map = buildUnitMap();</p>
<p class="p1"><span class="Apple-converted-space">  </span>unitSelect.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>Object.keys(map).sort((a,b)=&gt;Number(a)-Number(b)).forEach(no=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>const opt = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">    </span>opt.value = no; opt.textContent = `単元 ${no}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>unitSelect.appendChild(opt);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>unitSelect.onchange = refreshSubunits;</p>
<p class="p1"><span class="Apple-converted-space">  </span>subunitSelect.onchange = ()=&gt; renderQuestion(true);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>refreshSubunits();</p>
<p class="p1"><span class="Apple-converted-space">  </span>renderQuestion(true);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function refreshSubunits(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const map = buildUnitMap();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const selUnit = unitSelect.value || Object.keys(map)[0];</p>
<p class="p1"><span class="Apple-converted-space">  </span>const subs = map[selUnit] || [];</p>
<p class="p1"><span class="Apple-converted-space">  </span>subunitSelect.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>subs.forEach(k=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>const opt = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">    </span>opt.value = k; opt.textContent = k;</p>
<p class="p1"><span class="Apple-converted-space">    </span>subunitSelect.appendChild(opt);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>subunitTitle.textContent = subunitSelect.value;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function renderQuestion(resetCursor=false){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sub = subunitSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">  </span>subunitTitle.textContent = sub;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const data = getProgress(sub);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const list = units[sub];</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(!list || list.length===0){</p>
<p class="p1"><span class="Apple-converted-space">    </span>questionText.textContent = "この小単元には問題がありません。";</p>
<p class="p1"><span class="Apple-converted-space">    </span>optionsDiv.innerHTML = ""; feedback.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">    </span>return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(resetCursor){</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(data.cursor &lt; 0) data.cursor = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(data.cursor &gt;= list.length) data.cursor = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>setProgress(sub, data);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>const idx = data.cursor;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const item = list[idx];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>qCounter.textContent = `${idx+1} / ${list.length}`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>questionText.textContent = item.q;</p>
<p class="p1"><span class="Apple-converted-space">  </span>optionsDiv.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>feedback.innerHTML = "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const solved = data.correct.length;</p>
<p class="p1"><span class="Apple-converted-space">  </span>progressText.textContent = `${solved}/${list.length}`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>progressBar.style.width = `${(solved/list.length)*100}%`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>item.options.forEach((op, i)=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">    </span>btn.className = 'opt';</p>
<p class="p1"><span class="Apple-converted-space">    </span>btn.innerHTML = `&lt;b&gt;${i+1}.&lt;/b&gt; ${op}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>btn.addEventListener('click', ()=&gt; onAnswer(i+1));</p>
<p class="p1"><span class="Apple-converted-space">    </span>optionsDiv.appendChild(btn);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function moveQuestion(delta){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sub = subunitSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const data = getProgress(sub);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const list = units[sub];</p>
<p class="p1"><span class="Apple-converted-space">  </span>data.cursor += delta;</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(data.cursor &lt; 0) data.cursor = list.length-1;</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(data.cursor &gt;= list.length) data.cursor = 0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>setProgress(sub, data);</p>
<p class="p1"><span class="Apple-converted-space">  </span>renderQuestion();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function onAnswer(choice){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sub = subunitSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const data = getProgress(sub);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const list = units[sub];</p>
<p class="p1"><span class="Apple-converted-space">  </span>const idx = data.cursor;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const correctIdx = list[idx].answer;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>[...optionsDiv.children].forEach((b,i)=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">    </span>b.classList.remove('correct','wrong');</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(i+1===choice) b.classList.add(choice===correctIdx ? 'correct':'wrong');</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if(choice === correctIdx){</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(!data.correct.includes(idx)){</p>
<p class="p1"><span class="Apple-converted-space">      </span>data.correct.push(idx);</p>
<p class="p1"><span class="Apple-converted-space">      </span>setProgress(sub, data);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const guardKey = awardedKey(sub, idx);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(!localStorage.getItem(guardKey)){</p>
<p class="p1"><span class="Apple-converted-space">        </span>localStorage.setItem(guardKey, "1");</p>
<p class="p1"><span class="Apple-converted-space">        </span>const res = awardCharacter();</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(res.awarded){</p>
<p class="p1"><span class="Apple-converted-space">          </span>feedback.innerHTML = `&lt;p style="color:var(--ok);font-weight:700"&gt;正解！ ${res.message}&lt;/p&gt;&lt;img src="${res.url}" alt="new character"&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">          </span>feedback.innerHTML = `&lt;p style="color:var(--ok);font-weight:700"&gt;正解！ ${res.message}&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">        </span>feedback.innerHTML = `&lt;p style="color:var(--ok);font-weight:700"&gt;正解！（この問題は既にクリア済み）&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">      </span>feedback.innerHTML = `&lt;p style="color:var(--ok);font-weight:700"&gt;正解！（この問題は既にクリア済み）&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">    </span>feedback.innerHTML = `&lt;p style="color:#d33;font-weight:700"&gt;ざんねん！もう一度挑戦しよう&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const solved = getProgress(sub).correct.length;</p>
<p class="p1"><span class="Apple-converted-space">  </span>progressText.textContent = `${solved}/${list.length}`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>progressBar.style.width = `${(solved/list.length)*100}%`;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ============ コレクション表示 ============ */</p>
<p class="p1">function showCollection(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const grid = document.getElementById('collectionGrid');</p>
<p class="p1"><span class="Apple-converted-space">  </span>grid.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">  </span>const col = getCollection();</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(col.length===0){</p>
<p class="p1"><span class="Apple-converted-space">    </span>grid.innerHTML = `&lt;p class="muted"&gt;まだキャラクターを持っていません。&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">    </span>col.forEach(url=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const img = document.createElement('img');</p>
<p class="p1"><span class="Apple-converted-space">      </span>img.src = url;</p>
<p class="p1"><span class="Apple-converted-space">      </span>grid.appendChild(img);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>collectionCard.style.display = "block";</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ============ 起動時：自動ログイン ============ */</p>
<p class="p1">(async function boot(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const saved = loadUser();</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(saved){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// 自動ログインは「認証済みブラウザ」を前提（PW再入力なし）</p>
<p class="p1"><span class="Apple-converted-space">    </span>currentUser = saved;</p>
<p class="p1"><span class="Apple-converted-space">    </span>afterLogin();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}else{</p>
<p class="p1"><span class="Apple-converted-space">    </span>showLogin();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1">})();</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
